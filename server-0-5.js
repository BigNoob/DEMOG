//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//  										DE-MOG
// 					Dictator Experiment through Multiplayer Online Game
//
// Date: 2014/06/18
// Version: 0.5
// Author: Olivier Allouard
// Website: running-pande.fr
// Contact: olivier.allouard@gmail.com
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// Express
// Socket.io relative variables and initialization
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
var express = require('express');
var routes = require('routes');
var http = require('http');

var app = express();
var server = app.listen(process.env.PORT || 8099);
var io = require("socket.io").listen(server);
io.set('log level', 0);

app.configure(function(){
    app.set('views', __dirname + '/views');
    app.use(express.favicon());
    app.use(express.logger('dev'));
    app.use(express.static(__dirname + '/public'));
    app.use(express.bodyParser());
    app.use(express.methodOverride());
    app.use(app.router);
    app.use("/public",express.static(__dirname+"/public"));
});

console.log(server.address().port);

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 
// Project-relative Modules
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var xpGen = require('./serverLibs/experiment.js');
var XPGenerator = xpGen.Experiment;

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 
// Project Variables
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

var testXP = CreateExperiment("test","amazon",4,"space_coop");

//DEBUG
testXP.startXp();
testXP.exportResults();

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// 
// Helpers Function
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function CreateExperiment(name,type,iter,game)
{
	try{
		return(new xpGen.Experiment(name,type,iter,game));
	}catch(err)
	{
		console.log(err);
	}
}